!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Vanage=e()}}(function(){return function e(t,n,r){function o(u,s){if(!n[u]){if(!t[u]){var f="function"==typeof require&&require;if(!s&&f)return f(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return o(n?n:e)},a,a.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("./src/utils/uuid"),i=e("./src/Service"),u=o(),s=u.replace(/-/g,"");t.exports=function(e){function t(){return new i({identifier:u,debug:!1})}return("undefined"==typeof window?"undefined":r(window))!==e?(window[s]=t(),window[s]):t()}()},{"./src/Service":6,"./src/utils/uuid":12}],2:[function(e,t,n){function r(){d&&a&&(d=!1,a.length?l=a.concat(l):p=-1,l.length&&o())}function o(){if(!d){var e=s(r);d=!0;for(var t=l.length;t;){for(a=l,l=[];++p<t;)a&&a[p].run();p=-1,t=l.length}a=null,d=!1,f(e)}}function i(e,t){this.fun=e,this.array=t}function u(){}var s,f,c=t.exports={};!function(){try{s=setTimeout}catch(e){s=function(){throw new Error("setTimeout is not defined")}}try{f=clearTimeout}catch(e){f=function(){throw new Error("clearTimeout is not defined")}}}();var a,l=[],d=!1,p=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new i(e,t)),1!==l.length||d||s(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=u,c.addListener=u,c.once=u,c.off=u,c.removeListener=u,c.removeAllListeners=u,c.emit=u,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this.internals={},this.dirty=!1}return o(e,[{key:"set",value:function(e,t){this.internals[e]=t,this.dirty=!0}},{key:"get",value:function(e){return this.internals[e]}},{key:"flush",value:function(){this.internals={}}},{key:"dump",value:function(){return this.internals}},{key:"isDirty",value:function(){return this.dirty}},{key:"size",get:function(){return this.entries().length}},{key:"entries",get:function(){return Object.keys(this.internals)}}]),e}();t.exports=i},{}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name=n.constructor.name,n.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=new Error(e).stack,n}return i(t,e),u(t,[{key:"setCallee",value:function(e){this.callee=e}}]),t}(Error),f=function(e){function t(e){return r(this,t),o(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),t}(s);n.ExtendableServiceError=s,n.ServiceError=f},{}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./utils/equal"),u=e("./utils/uuid"),s=function(){function e(t){r(this,e),this.base=t,this.id=u()}return o(e,[{key:"match",value:function(e){return i(this.base,e)}},{key:"keys",value:function(){return Object.keys(this.base)}},{key:"signature",value:function(){var e=this.keys().length,t=0,n="";for(var r in this.base)n+=0===t?"":"&",n+=r+"="+this.base[r],t++;return n+="@"+this.id.replace(/-/g,"")+"#"+e}}]),e}();t.exports=s},{"./utils/equal":8,"./utils/uuid":12}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./utils/uuid"),s=e("./utils/noop"),f=e("./utils/debug"),c=e("./utils/stringify"),a=e("./utils/errors"),l=e("./Cache"),d=e("./Pattern"),p=function(){function e(t){r(this,e),this.options=t||{},this.id=t.identifier||u(),this.debug=s,this._internalId=Math.random().toString(36).slice(-12),this._history=new l,this._cache=new l,this._delegates=[],this._handlers=[]}return i(e,[{key:"configure",value:function(e){if("object"===("undefined"==typeof e?"undefined":o(e)))for(var t in e)this.options[t]=e[t];this._postConfigHook()}},{key:"set",value:function(e,t){this.options[e]=t,this._postConfigHook()}},{key:"register",value:function(e,t){var n=this;if(this.debug("Registring new handler for %s",c(e)),"object"!==("undefined"==typeof e?"undefined":o(e)))throw new a.RegisterError("Endpoint target must be an object and not type "+("undefined"==typeof e?"undefined":o(e)));var r=this._handlers.push({pattern:new d(e),handler:t,service:n._internalId}),i=this._handlers[r-1];this._cache.set(i.pattern.signature(),i)}},{key:"act",value:function(e,t,n){var r=this;if(t=t||{},n="function"==typeof n?n:s,!e)throw new a.ActError("No target defined to act event on");this.debug("%s for %s with data %s",t.__delegate__?"Delegating Action":"Acting",c(e),c(t)),this._history.set(new d(e).signature(),{data:t,stamp:Date.now(),target:e,resolver:n}),this._delegates.forEach(function(i){i.pattern.match(e)&&(r.debug("Found delegation for %s",c(e)),i.delegate.apply(null,[function(i,u){"object"!==("undefined"==typeof u?"undefined":o(u))?u=t:u.origin=t,r.debug("Delegate target %s to %s",c(e),c(i)),u.__delegate__=e,r.act(i,u,n)}]))}),this._handlers.forEach(function(i){i.pattern.match(e)&&i.handler.apply(null,[t,function(i,u){return r.debug("Handling factory %s with data %s",c(e),c(t)),n.apply(null,[i,u,function(n,i){"object"!==("undefined"==typeof i?"undefined":o(i))&&(i={}),i.__delegate__=e,i.origin=t,r.act(n,i)}])}])})}},{key:"delegate",value:function(e,t){var n=this;if(this.debug("Registering delegate for %s",c(e)),"object"!==("undefined"==typeof e?"undefined":o(e)))throw new a.DelegationError("Delegation ressource must be an object and not "+("undefined"==typeof e?"undefined":o(e)));if("function"!=typeof t)throw new a.DelegationError("Delegators need a function to delegate, received "+("undefined"==typeof t?"undefined":o(t)));var r=this._delegates.push({pattern:new d(e),delegate:t,service:n._internalId}),i=this._delegates[r-1];this._cache.set(i.pattern.signature(),i)}},{key:"_postConfigHook",value:function(){this.debug=f(this.options.debug)}}]),e}();t.exports=p},{"./Cache":3,"./Pattern":5,"./utils/debug":7,"./utils/errors":9,"./utils/noop":10,"./utils/stringify":11,"./utils/uuid":12}],7:[function(e,t,n){(function(n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("./noop");t.exports=function(e){if(e&&void 0!==("undefined"==typeof console?"undefined":r(console))){if("function"==typeof console.debug)return console.debug.bind(console);if("function"==typeof console.log)return console.log.bind(console);if(n&&"function"==typeof n.stdout.write)return n.stdout.write.bind(n)}return o}}).call(this,e("_process"))},{"./noop":10,_process:2}],8:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=void 0,o=Object.keys(e).sort(),i=Object.keys(t).sort();if(n=n===!0,o.length!==i.length)return!1;if(o.join("")!==i.join(""))return!1;for(r=0;r<o.length;++r){if(e[o[r]]instanceof Array){if(!(t[o[r]]instanceof Array))return!1;if(t[o[r]].sort().join("")!==e[o[r]].sort().join(""))return!1}else if(e[o[r]]instanceof Date){if(!(t[o[r]]instanceof Date))return!1;if(""+e[o[r]]!=""+t[o[r]])return!1}else if(e[o[r]]instanceof Function){if(!(t[o[r]]instanceof Function))return!1}else if(e[o[r]]instanceof Object){if(!(t[o[r]]instanceof Object))return!1;if(e[o[r]]===e){if(t[o[r]]!==t)return!1}else if(compareObjects(e[o[r]],t[o[r]])===!1)return!1}if(n){if(e[o[r]]!=t[o[r]])return!1}else if(e[o[r]]!==t[o[r]])return!1}return!0}},{}],9:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=e("../Error").ExtendableServiceError,s=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="DelegationError",n.callee="Service.delegate",n}return i(t,e),t}(u),f=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="ActError",n.callee="Service.act",n}return i(t,e),t}(u),c=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="RegisterError",n.callee="Service.register",n}return i(t,e),t}(u);n.DelegationError=s,n.ActError=f,n.RegisterError=c},{"../Error":4}],10:[function(e,t,n){"use strict";t.exports=function(){}},{}],11:[function(e,t,n){"use strict";t.exports=function(e){return"string"==typeof e?e:Array.isArray(e)?e.join(", "):void 0!==e.toISOString?e.toISOString():JSON.stringify(e)}},{}],12:[function(e,t,n){"use strict";var r=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};t.exports=function(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}},{}]},{},[1])(1)});
//# sourceMappingURL=vanage.min.js.map
