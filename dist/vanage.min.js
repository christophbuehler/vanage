!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Vanage=e()}}(function(){return function e(t,n,r){function o(u,f){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!f&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var a=n[u]={exports:{}};t[u][0].call(a.exports,function(e){var n=t[u][1][e];return o(n?n:e)},a,a.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";var r=e("./src/utils/uuid"),o=e("./src/Service"),i=e("./src/Cache");t.exports=function(e){return{Cache:i,Service:o,create:function t(e){return e=e||{debug:!1},new o(e)},generateId:r}}()},{"./src/Cache":3,"./src/Service":6,"./src/utils/uuid":15}],2:[function(e,t,n){function r(){y&&a&&(y=!1,a.length?l=a.concat(l):p=-1,l.length&&o())}function o(){if(!y){var e=f(r);y=!0;for(var t=l.length;t;){for(a=l,l=[];++p<t;)a&&a[p].run();p=-1,t=l.length}a=null,y=!1,c(e)}}function i(e,t){this.fun=e,this.array=t}function u(){}var f,c,s=t.exports={};!function(){try{f=setTimeout}catch(e){f=function(){throw new Error("setTimeout is not defined")}}try{c=clearTimeout}catch(e){c=function(){throw new Error("clearTimeout is not defined")}}}();var a,l=[],y=!1,p=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new i(e,t)),1!==l.length||y||f(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=u,s.addListener=u,s.once=u,s.off=u,s.removeListener=u,s.removeAllListeners=u,s.emit=u,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){r(this,e),this.name="Vanage.Cache",this.internals={},this.dirty=!1}return o(e,[{key:"set",value:function t(e,n){this.internals[e]=n,this.dirty=!0}},{key:"get",value:function n(e){return this.internals[e]}},{key:"flush",value:function i(){this.internals={}}},{key:"dump",value:function u(){return this.internals}},{key:"isDirty",value:function f(){return this.dirty}},{key:"size",get:function c(){return this.entries.length}},{key:"entries",get:function s(){return Object.keys(this.internals)}}]),e}();t.exports=i},{}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name=n.constructor.name,n.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(n,n.constructor):n.stack=new Error(e).stack,n}return i(t,e),u(t,[{key:"setCallee",value:function n(e){this.callee=e}}]),t}(Error),c=function(e){function t(e){return r(this,t),o(this,Object.getPrototypeOf(t).call(this,e))}return i(t,e),t}(f);n.ExtendableServiceError=f,n.ServiceError=c},{}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("./Signature"),u=e("./utils/equal"),f=e("./utils/uuid"),c=function(){function e(t){r(this,e),this.name="Vanage.Pattern",this.base=t,this.id=f(),this.signature=new i(this.id,this.base).value}return o(e,[{key:"match",value:function t(e){return u(this.base,e)}},{key:"keys",get:function n(){return Object.keys(this.base)}}]),e}();t.exports=c},{"./Signature":7,"./utils/equal":9,"./utils/uuid":15}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./utils/uuid"),f=e("./utils/noop"),c=e("./utils/debug"),s=e("./utils/stringify"),a=e("./utils/errors"),l=e("./Cache"),y=e("./Pattern"),p=function(){function e(t){r(this,e),this.name="Vanage.Service",this.options=t||{},this.id=t.identifier||u(),this.debug=f,this._internalId=Math.random().toString(36).slice(-12),this._history=new l,this._cache=new l,this._delegates=[],this._handlers=[]}return i(e,[{key:"configure",value:function t(e){if("object"===("undefined"==typeof e?"undefined":o(e)))for(var t in e)this.options[t]=e[t];this._postConfigHook()}},{key:"set",value:function n(e,t){this.options[e]=t,this._postConfigHook()}},{key:"register",value:function p(e,t){var n=this;if(this.debug("Registring new handler for %s",s(e)),"object"!==("undefined"==typeof e?"undefined":o(e)))throw new a.RegisterError("Endpoint target must be an object and not type "+("undefined"==typeof e?"undefined":o(e)));var r=this._handlers.push({pattern:new y(e),handler:t,service:n._internalId}),i=this._handlers[r-1];this._cache.set(i.pattern.signature,i)}},{key:"act",value:function d(e,t,n){var r=this;if(t=t||{},n="function"==typeof n?n:f,!e)throw new a.ActError("No target defined to act event on");this.debug("%s for %s with data %s",t.__delegate__?"Delegating Action":"Acting",s(e),s(t)),this._history.set(new y(e).signature,{data:t,stamp:Date.now(),target:e,resolver:n}),this._delegates.forEach(function(i){i.pattern.match(e)&&(r.debug("Found delegation for %s",s(e)),i.delegate.apply(null,[function(i,u){"object"!==("undefined"==typeof u?"undefined":o(u))?u=t:u.origin=t,r.debug("Delegate target %s to %s",s(e),s(i)),u.__delegate__=e,r.act(i,u,n)}]))}),this._handlers.forEach(function(i){i.pattern.match(e)&&i.handler.apply(null,[t,function(i,u){return r.debug("Handling factory %s with data %s",s(e),s(t)),n.apply(null,[i,u,function(n,i){"object"!==("undefined"==typeof i?"undefined":o(i))&&(i={}),i.__delegate__=e,i.origin=t,r.act(n,i)}])}])})}},{key:"delegate",value:function h(e,t){var n=this;if(this.debug("Registering delegate for %s",s(e)),"object"!==("undefined"==typeof e?"undefined":o(e)))throw new a.DelegationError("Delegation ressource must be an object and not "+("undefined"==typeof e?"undefined":o(e)));if("function"!=typeof t)throw new a.DelegationError("Delegators need a function to delegate, received "+("undefined"==typeof t?"undefined":o(t)));var r=this._delegates.push({pattern:new y(e),delegate:t,service:n._internalId}),i=this._delegates[r-1];this._cache.set(i.pattern.signature,i)}},{key:"_postConfigHook",value:function b(){this.debug=c(this.options.debug)}}]),e}();t.exports=p},{"./Cache":3,"./Pattern":5,"./utils/debug":8,"./utils/errors":10,"./utils/noop":13,"./utils/stringify":14,"./utils/uuid":15}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=e("./utils/uuid"),f=function(){function e(t,n){r(this,e),this.identifier=n||{},this.unique=t||u()}return i(e,[{key:"_stringifyObjectLike",value:function t(e){var t=this;if(Array.isArray(e))return e.join(",");if("string"==typeof e)return e;if("object"===("undefined"==typeof e?"undefined":o(e))){var n="",r=0;for(var i in e)Array.isArray(e[i])||"object"!==o(e[i])||(n+=t._stringifyObjectLike(e[i])),n+=0===r?"":"&",n+=i+":"+e[i],r++;return n}return JSON.stringify(e)}},{key:"value",get:function n(){var e=this.identifierKeys.length,t=this._stringifyObjectLike(this.identifier);return t+="@"+this.unique.replace(/-/g,"")+"#"+e}},{key:"identifierKeys",get:function f(){return Object.keys(this.identifier)}}]),e}();t.exports=f},{"./utils/uuid":15}],8:[function(e,t,n){(function(n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("./noop");t.exports=function(e){if(e&&void 0!==("undefined"==typeof console?"undefined":r(console))){if("function"==typeof console.debug)return console.debug.bind(console);if("function"==typeof console.log)return console.log.bind(console);if(n&&"function"==typeof n.stdout.write)return n.stdout.write.bind(n)}return o}}).call(this,e("_process"))},{"./noop":13,_process:2}],9:[function(e,t,n){"use strict";function r(e){return null===e||void 0===e}function o(e){return!(!e||"object"!==("undefined"==typeof e?"undefined":u(e))||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&!(e.length>0&&"number"!=typeof e[0]))}function i(e,t,n){var i=void 0,l=void 0,y=void 0,p=void 0;if(r(e)||r(t))return!1;if(e.prototype!==t.prototype)return!1;if(s(e))return!!s(t)&&(e=f.call(e),t=f.call(t),a(e,t,n));if(o(e)){if(!o(t))return!1;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}try{y=c(e),p=c(t)}catch(d){return!1}if(y.length!=p.length)return!1;for(y.sort(),p.sort(),i=y.length-1;i>=0;i--)if(y[i]!=p[i])return!1;for(i=y.length-1;i>=0;i--)if(l=y[i],!a(e[l],t[l],n))return!1;return("undefined"==typeof e?"undefined":u(e))===("undefined"==typeof t?"undefined":u(t))}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},f=Array.prototype.slice,c=e("./keys"),s=e("./isArguments"),a=t.exports=function(e,t,n){return n=n||{},e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=("undefined"==typeof e?"undefined":u(e))&&"object"!=("undefined"==typeof t?"undefined":u(t))?n.strict?e===t:e==t:i(e,t,n))}},{"./isArguments":11,"./keys":12}],10:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=e("../Error").ExtendableServiceError,f=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="DelegationError",n.callee="Service.delegate",n}return i(t,e),t}(u),c=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="ActError",n.callee="Service.act",n}return i(t,e),t}(u),s=function(e){function t(e){r(this,t);var n=o(this,Object.getPrototypeOf(t).call(this,e));return n.name="RegisterError",n.callee="Service.register",n}return i(t,e),t}(u);n.DelegationError=f,n.ActError=c,n.RegisterError=s},{"../Error":4}],11:[function(e,t,n){"use strict";function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==("undefined"==typeof e?"undefined":i(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u="[object Arguments]"==function(e){return Object.prototype.toString.call(arguments)}();t.exports=u?r:o,n.supported=r,n.unsupported=o},{}],12:[function(e,t,n){"use strict";function r(e){var t=[];for(var n in e)t.push(n);return t}n=t.exports=function(e){return"function"==typeof Object.keys?Object.keys:r}(),n.shim=r},{}],13:[function(e,t,n){"use strict";t.exports=function(){}},{}],14:[function(e,t,n){"use strict";t.exports=function(e){return"string"==typeof e?e:Array.isArray(e)?e.join(", "):void 0!==e.toISOString?e.toISOString():JSON.stringify(e)}},{}],15:[function(e,t,n){"use strict";var r=function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};t.exports=function i(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}},{}]},{},[1])(1)});
//# sourceMappingURL=vanage.min.js.map
