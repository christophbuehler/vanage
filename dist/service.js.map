{"version":3,"names":[],"mappings":"","sources":["service.js"],"sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.Service = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar uuid = require('./src/uuid');\nvar Service = require('./src/common/Service');\n\nmodule.exports = new Service();\n\n},{\"./src/common/Service\":4,\"./src/uuid\":6}],2:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Cache = function () {\n    function Cache() {\n        _classCallCheck(this, Cache);\n\n        this.data = {};\n    }\n\n    _createClass(Cache, [{\n        key: 'set',\n        value: function set(key, value) {\n            this.data[key] = value;\n        }\n    }, {\n        key: 'get',\n        value: function get(key) {\n            return this.data[key];\n        }\n    }]);\n\n    return Cache;\n}();\n\nmodule.exports = Cache;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar equals = require('../equal');\nvar uuid = require('../uuid');\n\nvar Pattern = function () {\n    function Pattern(identifier) {\n        _classCallCheck(this, Pattern);\n\n        this.base = identifier;\n        this.id = uuid();\n    }\n\n    _createClass(Pattern, [{\n        key: 'match',\n        value: function match(foreign) {\n            return equals(this.base, foreign);\n        }\n    }, {\n        key: 'keys',\n        value: function keys() {\n            return Object.keys(this.base);\n        }\n    }]);\n\n    return Pattern;\n}();\n\nmodule.exports = Pattern;\n\n},{\"../equal\":5,\"../uuid\":6}],4:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar uuid = require('../uuid');\nvar Cache = require('./Cache');\nvar Pattern = require('./Pattern');\n\nvar Service = function () {\n    function Service(options) {\n        _classCallCheck(this, Service);\n\n        this.options = options || {};\n        this.id = uuid();\n\n        this._cache = new Cache();\n        this._delegates = [];\n        this._handlers = [];\n    }\n\n    _createClass(Service, [{\n        key: 'register',\n        value: function register(ressource, handler) {\n            var index = this._handlers.push({\n                pattern: new Pattern(ressource),\n                handler: handler\n            });\n\n            this._cache.set(this._handlers[index].pattern.id, this._handlers[index]);\n        }\n    }, {\n        key: 'act',\n        value: function act(target, data, resolver) {\n            this._delegates.forEach(function (delegate) {\n                if (delegate.pattern.match(target)) {\n                    delegate.handler.apply(null, data, function () {\n                        /* delegate callback fn */\n                    });\n                }\n            });\n\n            this._handlers.forEach(function (delegate) {\n                if (delegate.pattern.match(target)) {\n                    delegate.handler.apply(null, data, function () {\n                        /* callback fn */\n                    });\n                }\n            });\n        }\n    }, {\n        key: 'delegate',\n        value: function delegate(ressource, delegation) {\n            var index = this._delegates.push({\n                pattern: new Pattern(ressource),\n                delegate: delegation\n            });\n\n            this._cache.set(this._delegates[index].pattern.id, this._delegates[index]);\n        }\n    }]);\n\n    return Service;\n}();\n\nmodule.exports = Service;\n\n},{\"../uuid\":6,\"./Cache\":2,\"./Pattern\":3}],5:[function(require,module,exports){\n'use strict';\n\nmodule.exports = function deepEqual(o, p, loose) {\n    var i = void 0;\n\n    var lkeys = Object.keys(o).sort();\n    var rkeys = Object.keys(p).sort();\n\n    loose = loose === true ? true : false;\n\n    if (lkeys.length !== rkeys.length) {\n        return false; // not the same nr of keys\n    }\n\n    if (lkeys.join('') !== rkeys.join('')) {\n        return false; // different keys\n    }\n\n    for (i = 0; i < lkeys.length; ++i) {\n        if (o[lkeys[i]] instanceof Array) {\n            if (!(p[lkeys[i]] instanceof Array)) {\n                return false;\n            }\n\n            // if (compareObjects(o[lkeys[i]], p[lkeys[i]] === false) return false\n            // would work, too, and perhaps is a better fit, still, this is easy, too\n            if (p[lkeys[i]].sort().join('') !== o[lkeys[i]].sort().join('')) {\n                return false;\n            }\n        } else if (o[lkeys[i]] instanceof Date) {\n            if (!(p[lkeys[i]] instanceof Date)) {\n                return false;\n            }\n\n            if ('' + o[lkeys[i]] !== '' + p[lkeys[i]]) {\n                return false;\n            }\n        } else if (o[lkeys[i]] instanceof Function) {\n            if (!(p[lkeys[i]] instanceof Function)) {\n                return false;\n            }\n            // ignore functions, or check them regardless?\n        } else if (o[lkeys[i]] instanceof Object) {\n            if (!(p[lkeys[i]] instanceof Object)) {\n                return false;\n            }\n\n            if (o[lkeys[i]] === o) {\n                // self reference?\n                if (p[lkeys[i]] !== p) {\n                    return false;\n                }\n            } else if (compareObjects(o[lkeys[i]], p[lkeys[i]]) === false) {\n                return false; // WARNING: does not deal with circular refs other than\n            }\n        }\n\n        if (loose) {\n            if (o[lkeys[i]] != p[lkeys[i]]) {\n                return false;\n            }\n        } else {\n            if (o[lkeys[i]] !== p[lkeys[i]]) {\n                return false; // not the same value\n            }\n        }\n    }\n\n    return true;\n};\n\n},{}],6:[function(require,module,exports){\n'use strict';\n\nvar guidBlock = function guidBlock() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n};\n\nmodule.exports = function guid() {\n    return guidBlock() + guidBlock() + '-' + guidBlock() + '-' + guidBlock() + '-' + guidBlock() + '-' + guidBlock() + guidBlock() + guidBlock();\n};\n\n},{}]},{},[1])(1)\n});"],"file":"service.js","sourceRoot":"/source/"}